# builder_app.py (STREAMLIT NO-CODE BUILDER)
import streamlit as st
import requests
import json
import os

# --- CONFIGURATION YA STREAMLIT ---
# HII LAZIMA IWE ANWANI YA RENDER YA APP YAKO LIVE
# BADILISHA HII NA URL HALISI YA RENDER YAKO
RENDER_API_URL = "https://aura01.onrender.com/create_ai" # <--- BADILISHA HII

st.set_page_config(page_title="Aura No-Code AI Builder", layout="centered")
st.title("ðŸ› ï¸ Aura No-Code AI Builder")
st.markdown("Jaza maelezo haya machache ili mfumo wetu wa Gemini ukutengenezee AI ya biashara yako. **Hakuna Code Inayohitajika!**")

# --- Fomu ya Kuunda AI ---
with st.form("ai_builder_form"):
    st.subheader("Maelezo ya Biashara Yako")
    ai_name = st.text_input("1. Jina la AI Yako (Mfano: Anna Bot):", max_chars=80)
    company_name = st.text_input("2. Jina la Kampuni/Biashara Yako:")
    product_details = st.text_area("3. Bidhaa au Huduma Zako (Maelezo Mafupi, mfano: Tunauza kuku wa kienyeji na kuwatuma Dar):")
    callback_number = st.text_input("4. Namba ya Simu ya Kuelekeza Wateja (Mfano: 07XX XXX XXX):")
    
    submitted = st.form_submit_button("Jenga AI Yangu Sasa!")

if submitted:
    # 1. Kusanya data
    data = {
        "ai_name": ai_name,
        "company_name": company_name,
        "product_details": product_details,
        "callback_number": callback_number
    }

    # 2. Tuma data kama JSON kwa Render API
    try:
        st.info("âš¡ï¸ Tunatuma maombi kwenye server ya Render...")
        response = requests.post(RENDER_API_URL, json=data)
        
        if response.status_code == 201:
            st.balloons()
            st.success(f"ðŸŽ‰ Imefanikiwa! {response.json().get('message')} ID: {response.json().get('ai_id')}")
        else:
            st.error(f"âŒ Kosa la Server: {response.status_code}. Hakikisha Flask/Render iko Live na DB inafanya kazi.")
            st.json(response.json())
    except requests.exceptions.RequestException as e:
        st.error(f"âŒ Kosa la Muunganisho. Hakikisha URL ({RENDER_API_URL}) ni sahihi na Render iko Online.")
